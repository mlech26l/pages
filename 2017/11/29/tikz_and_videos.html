<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Tikz and Videos | Home</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Tikz and Videos" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A simple way for generating animations and videos using LaTex and Tikz" />
<meta property="og:description" content="A simple way for generating animations and videos using LaTex and Tikz" />
<link rel="canonical" href="https://mlech26l.github.io/pages/2017/11/29/tikz_and_videos.html" />
<meta property="og:url" content="https://mlech26l.github.io/pages/2017/11/29/tikz_and_videos.html" />
<meta property="og:site_name" content="Home" />
<meta property="og:image" content="https://mlech26l.github.io/pages/images/tikz/map.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-11-29T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://mlech26l.github.io/pages/2017/11/29/tikz_and_videos.html","headline":"Tikz and Videos","datePublished":"2017-11-29T00:00:00-06:00","dateModified":"2017-11-29T00:00:00-06:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlech26l.github.io/pages/2017/11/29/tikz_and_videos.html"},"image":"https://mlech26l.github.io/pages/images/tikz/map.jpg","description":"A simple way for generating animations and videos using LaTex and Tikz","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/pages/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://mlech26l.github.io/pages/feed.xml" title="Home" /><link rel="shortcut icon" type="image/x-icon" href="/pages/images/favicon.ico"><link href="https://cdn.jsdelivr.net/npm/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/pages/">Home</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/pages/about/">About Me</a><a class="page-link" href="/pages/search/">Search</a><a class="page-link" href="/pages/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Tikz and Videos</h1><p class="page-description">A simple way for generating animations and videos using LaTex and Tikz</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2017-11-29T00:00:00-06:00" itemprop="datePublished">
        Nov 29, 2017
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#drawing-a-frame">Drawing a frame</a></li>
<li class="toc-entry toc-h1"><a href="#filling-the-placeholders">Filling the placeholders</a></li>
<li class="toc-entry toc-h1"><a href="#remarks">Remarks</a></li>
</ul><p>I am a really big fan of <strong>Vector graphics</strong> and I exhaustively use <a href="https://en.wikipedia.org/wiki/PGF/TikZ">Tikz</a> to draw such.
However, creating videos and cool animations with Tikz and Latex can be a bit messy.
So I have come up with a simple but effective hack to make generating videos with Latex easier.</p>

<p>The key idea is to have two separated Latex files: One that is manually created and stays the same over the whole video, and one that is procedurally generated for each frame.
The manual one is created as you would do usually write your Latex image. However, all variables that are dynamic throughout the video (e.g. color, position, opacity, etc.) are defined by placeholders. And, guess what, the second Latex file (the procedurally generated one) then fills all the placeholder for each frame.</p>

<h1 id="drawing-a-frame">
<a class="anchor" href="#drawing-a-frame" aria-hidden="true"><span class="octicon octicon-link"></span></a>Drawing a frame</h1>
<p>My starting point is the manually designed Latex file, that is based on the following scheme:</p>

<figure class="highlight"><pre><code class="language-tex" data-lang="tex"><span class="k">\documentclass</span><span class="na">[border=0cm,convert={outext=.png}]</span><span class="p">{</span>standalone<span class="p">}</span>
<span class="c">% Documentclass to directly create a PNG-files when invoking 'pdflatex'</span>

<span class="k">\usepackage</span><span class="p">{</span>xcolor<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>tikz<span class="p">}</span>

<span class="c">% Load dynamic variables</span>
<span class="k">\input</span><span class="p">{</span>dynamic.tex<span class="p">}</span>

<span class="nt">\begin{document}</span>
<span class="nt">\begin{tikzpicture}</span>

<span class="c">% My Latex code</span>
<span class="k">\node</span> (start) at (0,0) [draw,fill=<span class="k">\mycolorsin</span>] <span class="p">{</span>A<span class="p">}</span>;
<span class="k">\node</span> (start) at (2,0) [draw,fill=<span class="k">\mycolorcos</span>] <span class="p">{</span>B<span class="p">}</span>;

<span class="nt">\end{tikzpicture}</span>
<span class="nt">\end{document}</span></code></pre></figure>

<p>In this case a two nodes are drawn, which colors (<em>\mycolor</em>) should be animated.</p>

<p><img src="/pages/images/tikz/frame_000.png" alt="Latex"></p>

<h1 id="filling-the-placeholders">
<a class="anchor" href="#filling-the-placeholders" aria-hidden="true"><span class="octicon octicon-link"></span></a>Filling the placeholders</h1>

<p>In the next step I will create a simple <em>python</em> script that generates the <em>dynamic.tex</em> file and fills all the dynamic placeholder variables.
Moreover, the program invokes the Latex compiler to generate a PNG file out of the code and stores it in a directory.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="c1"># Create directory for the frames
</span><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="s">'sequence'</span><span class="p">):</span>
    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s">'sequence'</span><span class="p">)</span>

<span class="c1"># Example data for animation in range [0,100]
</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sin_seq</span> <span class="o">=</span> <span class="mf">50.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mf">50.0</span>
<span class="n">cos_seq</span> <span class="o">=</span> <span class="mf">50.0</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="mf">50.0</span>

<span class="c1"># Loop over each frame
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>

    <span class="c1"># Create file with for dynamic variables
</span>    <span class="n">dynamic_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'dynamic.tex'</span><span class="p">,</span><span class="s">'w'</span><span class="p">)</span>
    <span class="n">dynamic_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\\</span><span class="s">newcommand{</span><span class="se">\\</span><span class="s">mycolorsin}{green!'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sin_seq</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span><span class="o">+</span><span class="s">'!white}</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">dynamic_file</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'</span><span class="se">\\</span><span class="s">newcommand{</span><span class="se">\\</span><span class="s">mycolorcos}{red!'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">cos_seq</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span><span class="o">+</span><span class="s">'!white}</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">dynamic_file</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Create png with pdflatex
</span>    <span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="s">'pdflatex -shell-escape -interaction=nonstopmode example.tex'</span><span class="p">)</span>

    <span class="c1"># Move frame into directory with frames
</span>    <span class="n">shutil</span><span class="p">.</span><span class="n">move</span><span class="p">(</span><span class="s">'example.png'</span><span class="p">,</span> <span class="s">'sequence/frame_'</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="s">'.png'</span><span class="p">)</span></code></pre></figure>

<p>Finally, all I have to do is to animate the frames with <a href="https://en.wikipedia.org/wiki/ImageMagick">ImageMagick</a></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">convert <span class="nt">-loop</span> 0 <span class="nt">-delay</span> 2 sequence/<span class="k">*</span>.png animation.gif</code></pre></figure>

<p><img src="/pages/images/tikz/animation.gif" alt="Latex"></p>

<h1 id="remarks">
<a class="anchor" href="#remarks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Remarks</h1>
<ul>
  <li>Instead of using <em>\newcommand</em> for each placeholder, it might be more convinient to use <em>tikzset</em> or <em>tikzstyle</em> (<a href="https://tex.stackexchange.com/questions/52372/should-tikzset-or-tikzstyle-be-used-to-define-tikz-styles">See here</a>) to define the dynamic variables</li>
  <li>If you want to create a video instead of an animation (mp4 instead of gif), you can easily do this with <a href="https://en.wikipedia.org/wiki/FFmpeg">ffmpeg</a>
</li>
  <li>Technically the gif animation is not a vector graphics anymore. However by tuning the <em>pdf-to-png</em> conversion density parameter, one can create an animation with an arbitrary high resolution.</li>
</ul>

  </div><a class="u-url" href="/pages/2017/11/29/tikz_and_videos.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/pages/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/pages/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/pages/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Personal research blog and webpage</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/mlech26l" title="mlech26l"><svg class="svg-icon grey"><use xlink:href="/pages/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/MLech20" title="MLech20"><svg class="svg-icon grey"><use xlink:href="/pages/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
